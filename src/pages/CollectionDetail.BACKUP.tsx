// BACKUP of original complex version - kept for reference
